---
name: "si_lsqml"
backend: cupy

# raw data source
raw_data:
  type: empad
  path: "~/Downloads/si-final4/Si_110_Sn_300kV_conv25_defocus10_tds/Si_110_Sn_300kV_conv25_defocus10_tds_199.70_dstep0.8.json"

post_load:
 - type: poisson
   scale: 1.0e+7

# for each reconstruction engine
engines:
   # how to transition from previous state to current reconstruction state
   # how to reconstruct
   # how to output/save
 - type: 'conventional'
   probe_modes: 4
   slices:
     n: 20
     total_thickness: 200

   niter: 500
   grouping: 64

   noise_model:
     type: 'anscombe'
     eps: 0.1

   solver:
     type: 'lsqml'
     beta_probe: 0.9
     beta_object: 0.9
     gamma: 1.0e-2

     illum_reg_object: 50.0

   group_constraints:
     - type: limit_probe_support
       max_angle: 26.0
   iter_constraints:
     - type: layers
       sigma: 100.0
       weight: 0.4
     - remove_phase_ramp

   update_probe: {after: 5}

   save: {every: 10}
   save_images: {every: 10}
   save_options:
     images: [
      'probe', 'probe_recip', 'object_phase_sum', 'object_mag_sum',
      'object_phase_stack', 'object_mag_stack'
     ]